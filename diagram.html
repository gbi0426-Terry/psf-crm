<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'forest' });
    </script>
    <style>body { background: white; padding: 20px; font-family: sans-serif; }</style>
</head>
<body>
    <h2 style="text-align: center;">æœ‹ç¿ CRM V3.0 - å®Œæ•´ç³»çµ±å…¨è¦½åœ– (Master Architecture)</h2>
    <div class="mermaid" style="text-align: center;">
    graph TD
        subgraph Sources ["è³‡æ–™ä¾†æºå±¤ (Data Sources)"]
            style Sources fill:#fff0f6,stroke:#eb2f96,stroke-width:2px
            Web("ğŸŒ å®˜æ–¹ç¶²ç«™")
            Line("ğŸ’¬ å®˜æ–¹ LINE")
            Referral("ğŸ¤ åˆä½œå¤¥ä¼´å¼•è–¦")
        end

        subgraph L1 ["L1: æ¡ˆä»¶å—ç†å±¤"]
            style L1 fill:#e6f7ff,stroke:#1890ff,stroke-width:2px
            Leads("ğŸ£ æ½›åœ¨ç·šç´¢æ± <br/>(ç¶å®šæ¨è–¦äºº)")
            FollowUp("ğŸ“ è·Ÿé€²ç´€éŒ„<br/>(ç¢ºèªéœ€æ±‚/ç‹€æ…‹)")
            Pipeline("ğŸ“‹ æ¡ˆä»¶ç¸½ç®¡ (7éšæ®µSOP)<br/>1.è«®è©¢...7.è«‹æ¬¾")
        end

        subgraph L2 ["L2: æ¡ˆä»¶åŸ·è¡Œå±¤ (Case Execution)"]
            style L2 fill:#f6ffed,stroke:#52c41a,stroke-width:2px
            CaseOverview("ğŸ‘ï¸ æ¡ˆä»¶æ¦‚æ³<br/>(å…¨ç”Ÿå‘½é€±æœŸ/é‡Œç¨‹ç¢‘)")
            CaseDMS("ğŸ“‚ æ–‡ä»¶ä¸­å¿ƒ<br/>(ç¼ºä»¶æª¢æ ¸/å‚¬ä»¶)")
        end

        subgraph L3 ["L3: éŠ€è¡Œåª’åˆå±¤ (Bank Matching)"]
            style L3 fill:#fff7e6,stroke:#fa8c16,stroke-width:2px
            BankEval("âš–ï¸ é€ä»¶è©•ä¼°")
            Partners("ğŸ›ï¸ éŠ€è¡Œåˆä½œå¤¥ä¼´åº«<br/>(çª—å£ç®¡ç†/åå¥½)")
        end
        
        subgraph Sys ["ç³»çµ±æ”¯æ´å±¤ (System Support)"]
            style Sys fill:#f9f0ff,stroke:#722ed1,stroke-width:2px,stroke-dasharray: 5 5
            RBAC("ğŸ” æ¬Šé™ç®¡ç† (RBAC)")
            API("ğŸ”Œ API ä»‹æ¥")
        end

        %% Connections
        Web --> Leads
        Line --> Leads
        Referral --> Leads

        Leads -->|"1. é–‹å§‹è·Ÿé€²"| FollowUp
        FollowUp -->|"2. éœ€æ±‚ç¢ºèª (Qualified)"| Pipeline
        
        Pipeline -->|"3. é€²å…¥æ¡ˆä»¶ (Drill-down)"| CaseOverview
        
        CaseOverview -->|"4. æ”¶é›†è³‡æ–™"| CaseDMS
        CaseDMS -->|"5. è³‡æ–™å‚™é½Š"| BankEval
        
        BankEval -->|"6. åŒ¹é…æœ€é©åˆéŠ€è¡Œ"| Partners
        Partners -->|"7. é€ä»¶/å°ä¿"| Commission("ğŸ’° ä½£é‡‘çµç®—<br/>(åˆ†æ½¤è©¦ç®—)")

        %% Styling
        classDef main fill:#fff,stroke:#333,stroke-width:1px;
        class Web,Line,Referral,Leads,FollowUp,Pipeline,CaseOverview,CaseDMS,BankEval,Partners,Commission,RBAC,API main;
        linkStyle 9 stroke:red,stroke-width:2px; 
    </div>
</body>
</html>
